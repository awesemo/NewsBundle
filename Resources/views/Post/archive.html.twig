{% extends rz_admin_get_template('rz_news.template.news_layout_html') %}

{% block sonata_page_breadcrumb %}{% endblock %}

{% block post_body %}
    {% spaceless %}
        <div id="posts">
            {% for post in pager.getCurrentPageResults() %}
                {% set post_url = url('rz_news_view', { 'permalink': post.slug, '_format': 'html' }) %}
                <div class="pad20"></div>
                {% block post_media %}
                    {% if post.image %}
                        {% if post.image.providerName  == 'sonata.media.provider.image' %}
                            <div class="hover_img">
                                <a href="{%  path post.image, 'reference' %}" data-rel="prettyPhoto"><img src="{%  path post.image, 'reference' %}" alt=""/></a>
                            </div>
                        {% else %}
                            <div class="vendor">
                                {% media post.image, 'reference' %}
                            </div>
                        {% endif %}
                    {% endif %}
                {% endblock post_media %}

                {% block post_title %}
                    <h1 class="blog"><a href="{{ post_url }}">{{ post.title }}</a></h1>
                {% endblock post_title %}

                {% block post_title_details %}
                    <h4><b>{{ post.publicationDateStart | format_date }}</b> |  <b>{{ 'archive_author'|trans({'%author%': post.author }, 'SonataNewsBundle') }}</b> </h4>
                {% endblock post_title_details %}

                {% block post_abstract %}
                    <p>{{ post.abstract }}</p>
                {% endblock post_abstract %}

                {% block post_categories %}
                    <div class="post-meta muted">
                        <ul>
                            <li>Categories: </li>
                            <li>
                                {% for postHasCategory in post.postHasCategory %}
                                    {% if postHasCategory.enabled %}
                                        {% if not is_controller_enabled and postHasCategory.category.page %}
                                            {% set category_url = rz_render_page_alias_url(postHasCategory.category.page.getPageAlias()) %}
                                            {% if  category_url %}
                                                <a href="{{ url(category_url) }}">{{ postHasCategory.category.name }}</a>{% if not loop.last %}, {% endif %}
                                            {% else %}
                                                <a href="#">{{ postHasCategory.category.name }}</a>{% if not loop.last %}, {% endif %}
                                            {% endif %}
                                        {% else %}
                                            {% if postHasCategory.enabled %}
                                                <a href="{{ url('rz_news_category', { 'permalink': rz_classification_category_permalink(postHasCategory.category) } ) }}">{{ postHasCategory.category.name }}</a>{% if not loop.last %}, {% endif %}
                                            {% endif %}
                                        {% endif %}

                                    {% endif %}
                                {% endfor %}
                            </li>
                        </ul>
                    </div>
                {% endblock post_categories %}

                {% block post_tags %}
                    <div class="post-meta muted">
                        <ul>
                            <li>Tags: </li>
                            <li>
                                {% for tag in post.tags %}
                                    <a href="{{ url('rz_news_tag', { 'tag': tag.slug } ) }}">{{ tag.name }}</a>{% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </li>
                        </ul>
                    </div>
                {% endblock post_tags %}

                {% block post_read_more %}
                    <h4><a href="{{ url('rz_news_view', { 'permalink':  post.slug, '_format': 'html' }) }}"><b>READ &rarr;</b></a></h4>
                {% endblock post_read_more %}
                <!--end post-->
                <div class="pad30"></div>
            {% else %}
                <div class="row-fluid sonata-blog-post-list">
                    <div class="span12">
                        {{ 'no_post_found'|trans({}, 'SonataNewsBundle') }}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endspaceless %}
{% endblock post_body %}

{% block post_paginator %}
    {% if pager.haveToPaginate %}
        {% spaceless %}
        <div class="pagination">
            <ul class="span12">
                {% if pager.hasPreviousPage %}
                <li class="pull-left">
                    {% if type == 'yearly' %}
                    <a class="btn btn-rzcms-theme"
                       href="{{ url('rz_news_archive_yearly_pager', route_parameters|merge({'page': pager.previousPage})) }}"
                       title="{{ 'link_previous_page'|trans({}, 'SonataNewsBundle') }}">{{ 'link_previous_page'|trans({}, 'SonataNewsBundle') }}
                    </a>
                    {% elseif type == 'monthly' %}
                        <a class="btn btn-rzcms-theme"
                           href="{{ url('rz_news_archive_monthly_pager', route_parameters|merge({'page': pager.previousPage})) }}"
                           title="{{ 'link_previous_page'|trans({}, 'SonataNewsBundle') }}">{{ 'link_previous_page'|trans({}, 'SonataNewsBundle') }}
                        </a>
                    {% else %}
                        <a class="btn btn-rzcms-theme"
                           rel="prev"
                           href="{{ url('rz_news_archive_pager', route_parameters|merge({'page': pager.previousPage})) }}"
                           title="{{ 'link_previous_page'|trans({}, 'SonataNewsBundle') }}">{{ 'link_previous_page'|trans({}, 'SonataNewsBundle') }}
                        </a>
                    {% endif %}
                </li>
                {% endif %}
                {% if pager.hasNextPage %}
                <li class="pull-right">
                    {% if type == 'yearly' %}
                        <a class="btn btn-rzcms-theme"
                           href="{{ url('rz_news_archive_yearly_pager', route_parameters|merge({'page': pager.nextPage})) }}"
                           title="{{ 'link_next_page'|trans({}, 'SonataNewsBundle') }}">{{ 'link_next_page'|trans({}, 'SonataNewsBundle') }}
                        </a>
                    {% elseif type == 'monthly' %}
                        <a class="btn btn-rzcms-theme"
                           href="{{ url('rz_news_archive_monthly_pager', route_parameters|merge({'page': pager.nextPage})) }}"
                           title="{{ 'link_next_page'|trans({}, 'SonataNewsBundle') }}">{{ 'link_next_page'|trans({}, 'SonataNewsBundle') }}
                        </a>
                    {% else %}
                        <a class="btn btn-rzcms-theme"
                           rel="next"
                           href="{{ url('rz_news_archive_pager', route_parameters|merge({'page': pager.nextPage})) }}"
                           title="{{ 'link_next_page'|trans({}, 'SonataNewsBundle') }}">{{ 'link_next_page'|trans({}, 'SonataNewsBundle') }}
                        </a>
                    {% endif %}
                </li>
                {% endif %}
            </ul>
        </div>
        {% endspaceless %}
    {% endif %}
    <div class="clearfix"></div>
{% endblock post_paginator %}